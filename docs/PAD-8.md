Project Architecture Document: Atelier ArÃ´me
Holistic Re-Imagination & Implementation Planning
Phase 1: Deep Analysis & Vision
Current State Assessment
Aspect	Current State	Target State
Architecture	Static HTML/CSS/JS	Full-stack Next.js 14+ application
Data	Hardcoded JavaScript objects	PostgreSQL with Prisma ORM
E-commerce	Simulated cart only	Complete checkout with Stripe
Authentication	None	NextAuth.js with multiple providers
Content	Static HTML	Headless CMS integration ready
Search	None	Algolia/Meilisearch integration
Analytics	None	Plausible + custom event tracking
Email	None	Resend/SendGrid transactional email
Business Domain Model
text

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      ATELIER ARÃ”ME DOMAIN                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚  â”‚   CATALOG   â”‚    â”‚   ORDERS    â”‚    â”‚  CUSTOMERS  â”‚             â”‚
â”‚  â”‚             â”‚    â”‚             â”‚    â”‚             â”‚             â”‚
â”‚  â”‚ â€¢ Essences  â”‚â”€â”€â”€â–¶â”‚ â€¢ Cart      â”‚â—€â”€â”€â”€â”‚ â€¢ Accounts  â”‚             â”‚
â”‚  â”‚ â€¢ Variants  â”‚    â”‚ â€¢ Checkout  â”‚    â”‚ â€¢ Addresses â”‚             â”‚
â”‚  â”‚ â€¢ Inventory â”‚    â”‚ â€¢ Payments  â”‚    â”‚ â€¢ Wishlists â”‚             â”‚
â”‚  â”‚ â€¢ Humours   â”‚    â”‚ â€¢ Shipping  â”‚    â”‚ â€¢ Orders    â”‚             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚         â”‚                  â”‚                  â”‚                     â”‚
â”‚         â–¼                  â–¼                  â–¼                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚                    MANUSCRIPT                            â”‚       â”‚
â”‚  â”‚                                                          â”‚       â”‚
â”‚  â”‚  â€¢ Testimonials (Patron's Manuscript)                    â”‚       â”‚
â”‚  â”‚  â€¢ Folios (Content Pages)                                â”‚       â”‚
â”‚  â”‚  â€¢ Correspondence (Newsletter)                           â”‚       â”‚
â”‚  â”‚  â€¢ Alchemy (Process Documentation)                       â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
Phase 2: Implementation Plan for PAD
Document Structure Validation
Section	Purpose	Dependencies	Priority
1. Executive Summary	Project overview, decisions	None	P0
2. System Architecture	High-level technical design	Section 1	P0
3. Database Schema	Complete data model	Section 2	P0
4. API Specification	Backend contract	Section 3	P0
5. Frontend Architecture	Client application design	Sections 2, 4	P0
6. Design System	Visual language specification	Section 5	P1
7. User Experience	Flows and accessibility	Section 6	P1
8. Security	Protection measures	Sections 3, 4	P0
9. Performance	Optimization targets	All above	P1
10. Testing Strategy	Quality assurance	All above	P1
11. Deployment	Infrastructure & CI/CD	All above	P1
12. Development Guidelines	Team standards	All above	P2
13. Implementation Roadmap	Phased delivery	All above	P0
Validation Checkpoint
âœ… All e-commerce requirements covered (products, cart, checkout, orders)
âœ… Database schema supports business logic
âœ… API design enables frontend independence
âœ… Security considerations integrated throughout
âœ… Accessibility requirements documented
âœ… Performance targets defined
âœ… Deployment strategy included
âœ… No ambiguity in technical decisions
Proceeding to full PAD execution.

ğŸ“œ Project Architecture Document
Atelier ArÃ´me â€” Artisanal Alchemy for the Senses
Version: 2.0.0
Status: Production Architecture
Last Updated: 2024
Classification: Technical Specification â€” Single Source of Truth

Table of Contents
Executive Summary
System Architecture
Database Schema
API Specification
Frontend Architecture
Design System
User Experience
Security
Performance
Testing Strategy
Deployment
Development Guidelines
Implementation Roadmap
1. Executive Summary
1.1 Project Overview
Atelier ArÃ´me is a luxury artisanal aromatherapy e-commerce platform that sells handcrafted botanical essences. The digital experience is designed as an illuminated manuscript, honoring Renaissance aesthetics while providing modern e-commerce functionality.

1.2 Business Objectives
Objective	Metric	Target
Convert visitors to customers	Conversion Rate	3.5%+
Build email subscriber base	Newsletter Signups	15% of visitors
Establish luxury positioning	Average Order Value	$85+
Create memorable experience	Return Visitor Rate	40%+
Ensure accessibility	WCAG Compliance	AA (AAA for core flows)
1.3 Technical Objectives
Objective	Metric	Target
Fast initial load	LCP	< 2.0s
Smooth interactions	INP	< 150ms
Visual stability	CLS	< 0.05
SEO optimization	Core Web Vitals	All "Good"
Accessibility	Lighthouse A11y	100
Security	OWASP Top 10	Full compliance
1.4 Key Architectural Decisions
Decision	Choice	Rationale
Framework	Next.js 14+ (App Router)	SSR for SEO, Server Components for performance, unified full-stack
Database	PostgreSQL 16+	ACID compliance, JSON support, proven for e-commerce
ORM	Prisma	Type-safe, excellent DX, migrations built-in
Auth	NextAuth.js v5	Native Next.js integration, multiple providers
Payments	Stripe	Industry standard, excellent API, global coverage
Email	Resend	Modern API, React Email templates
Styling	Tailwind CSS 4.0	Utility-first, design system integration
Components	Shadcn/UI (customized)	Accessible primitives, full control
Hosting	Vercel	Native Next.js optimization, edge functions
Database Hosting	Neon / Supabase	Serverless PostgreSQL, auto-scaling
Media Storage	Cloudflare R2	S3-compatible, no egress fees
Search	Meilisearch	Fast, typo-tolerant, self-hostable
Analytics	Plausible	Privacy-focused, GDPR compliant
1.5 Glossary of Domain Terms
Term	Definition
Essence	A botanical aromatic product (e.g., Provence Lavender)
Humour	Product categorization by effect (Calming, Uplifting, Grounding, Clarifying)
Phial	Product container/unit (standard 5ml glass vial)
Folio	A content page or section (manuscript metaphor)
Compendium	The product catalog
Alchemy	The production/extraction process
Manuscript	Testimonials section
Correspondence	Newsletter/email communications
Vial	Shopping cart (collection vial)
Atelier	The workshop/brand studio
Patron	A customer who has purchased
Colophon	Footer with publication details
2. System Architecture
2.1 High-Level Architecture Diagram
text

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              CLIENT LAYER                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚  â”‚   Web Browser   â”‚  â”‚   Mobile Web    â”‚  â”‚   Native App    â”‚             â”‚
â”‚  â”‚   (Desktop)     â”‚  â”‚   (Responsive)  â”‚  â”‚   (Future)      â”‚             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚           â”‚                    â”‚                    â”‚                       â”‚
â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
â”‚                                â–¼                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                         CDN / EDGE LAYER                             â”‚   â”‚
â”‚  â”‚                         (Vercel Edge Network)                        â”‚   â”‚
â”‚  â”‚   â€¢ Static Assets (CSS, JS, Images)                                  â”‚   â”‚
â”‚  â”‚   â€¢ Edge Caching                                                     â”‚   â”‚
â”‚  â”‚   â€¢ Edge Middleware (Geolocation, A/B Testing)                       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                â”‚                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           APPLICATION LAYER                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                      NEXT.JS 14+ APPLICATION                         â”‚   â”‚
â”‚  â”‚                                                                       â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚   â”‚
â”‚  â”‚  â”‚  Server         â”‚  â”‚  API Routes     â”‚  â”‚  React Server   â”‚       â”‚   â”‚
â”‚  â”‚  â”‚  Components     â”‚  â”‚  /api/*         â”‚  â”‚  Actions        â”‚       â”‚   â”‚
â”‚  â”‚  â”‚                 â”‚  â”‚                 â”‚  â”‚                 â”‚       â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ Page SSR     â”‚  â”‚  â€¢ REST API     â”‚  â”‚  â€¢ Form Handlingâ”‚       â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ Data Fetch   â”‚  â”‚  â€¢ Webhooks     â”‚  â”‚  â€¢ Mutations    â”‚       â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ SEO          â”‚  â”‚  â€¢ Auth         â”‚  â”‚  â€¢ Revalidation â”‚       â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚   â”‚
â”‚  â”‚           â”‚                    â”‚                    â”‚                 â”‚   â”‚
â”‚  â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚   â”‚
â”‚  â”‚                                â–¼                                      â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚   â”‚
â”‚  â”‚  â”‚                    SERVICE LAYER                             â”‚     â”‚   â”‚
â”‚  â”‚  â”‚                                                              â”‚     â”‚   â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚     â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ Product  â”‚ â”‚  Order   â”‚ â”‚ Customer â”‚ â”‚ Content  â”‚       â”‚     â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ Service  â”‚ â”‚ Service  â”‚ â”‚ Service  â”‚ â”‚ Service  â”‚       â”‚     â”‚   â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚     â”‚   â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚     â”‚   â”‚
â”‚  â”‚  â”‚  â”‚  Cart    â”‚ â”‚ Payment  â”‚ â”‚  Email   â”‚ â”‚ Search   â”‚       â”‚     â”‚   â”‚
â”‚  â”‚  â”‚  â”‚ Service  â”‚ â”‚ Service  â”‚ â”‚ Service  â”‚ â”‚ Service  â”‚       â”‚     â”‚   â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚     â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚   â”‚
â”‚  â”‚                                â”‚                                      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                   â–¼                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                      DATA ACCESS LAYER                               â”‚    â”‚
â”‚  â”‚                      (Prisma ORM)                                    â”‚    â”‚
â”‚  â”‚                                                                      â”‚    â”‚
â”‚  â”‚  â€¢ Type-Safe Database Queries                                        â”‚    â”‚
â”‚  â”‚  â€¢ Migrations & Schema Management                                    â”‚    â”‚
â”‚  â”‚  â€¢ Connection Pooling (via Prisma Accelerate)                        â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                   â”‚                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                             DATA LAYER                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚  â”‚   PostgreSQL    â”‚  â”‚     Redis       â”‚  â”‚  Cloudflare R2  â”‚             â”‚
â”‚  â”‚   (Neon)        â”‚  â”‚   (Upstash)     â”‚  â”‚   (Media)       â”‚             â”‚
â”‚  â”‚                 â”‚  â”‚                 â”‚  â”‚                 â”‚             â”‚
â”‚  â”‚  â€¢ Products     â”‚  â”‚  â€¢ Sessions     â”‚  â”‚  â€¢ Product Imgs â”‚             â”‚
â”‚  â”‚  â€¢ Orders       â”‚  â”‚  â€¢ Cart Cache   â”‚  â”‚  â€¢ Uploads      â”‚             â”‚
â”‚  â”‚  â€¢ Customers    â”‚  â”‚  â€¢ Rate Limit   â”‚  â”‚  â€¢ Assets       â”‚             â”‚
â”‚  â”‚  â€¢ Content      â”‚  â”‚  â€¢ Queue Jobs   â”‚  â”‚                 â”‚             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         EXTERNAL SERVICES                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚  Stripe  â”‚ â”‚  Resend  â”‚ â”‚Meilisearchâ”‚ â”‚ Plausibleâ”‚ â”‚  Sentry  â”‚          â”‚
â”‚  â”‚ Payments â”‚ â”‚  Email   â”‚ â”‚  Search   â”‚ â”‚ Analyticsâ”‚ â”‚  Errors  â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
2.2 Technology Stack Details
2.2.1 Frontend Stack
Technology	Version	Purpose
Next.js	14.2+	React framework with App Router
React	18.3+	UI library
TypeScript	5.4+	Type safety
Tailwind CSS	4.0+	Utility-first styling
Shadcn/UI	Latest	Accessible component primitives
Framer Motion	11+	Animations (with reduced motion support)
Zustand	4+	Client state management
TanStack Query	5+	Server state management
React Hook Form	7+	Form handling
Zod	3+	Schema validation
2.2.2 Backend Stack
Technology	Version	Purpose
Next.js API Routes	14.2+	REST API endpoints
Prisma	5.10+	Database ORM
NextAuth.js	5+	Authentication
Stripe SDK	Latest	Payment processing
Resend	Latest	Transactional email
Upstash Redis	Latest	Caching & rate limiting
Uploadthing	Latest	File uploads
2.2.3 Infrastructure
Service	Provider	Purpose
Hosting	Vercel	Application hosting
Database	Neon	Serverless PostgreSQL
Cache	Upstash Redis	Session & data cache
Media	Cloudflare R2	Image & asset storage
CDN	Vercel Edge	Global content delivery
Search	Meilisearch Cloud	Product search
Monitoring	Sentry	Error tracking
Analytics	Plausible	Privacy-focused analytics
2.3 Data Flow Diagrams
2.3.1 Product Browsing Flow
text

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Client  â”‚â”€â”€â”€â”€â–¶â”‚   Edge   â”‚â”€â”€â”€â”€â–¶â”‚   RSC    â”‚â”€â”€â”€â”€â–¶â”‚  Prisma  â”‚
â”‚ Browser  â”‚     â”‚  Cache   â”‚     â”‚  Render  â”‚     â”‚  Query   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚                                  â”‚
                      â”‚ Cache Hit                        â”‚ Cache Miss
                      â–¼                                  â–¼
                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                 â”‚   HTML   â”‚                      â”‚PostgreSQLâ”‚
                 â”‚ Response â”‚                      â”‚ Database â”‚
                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
2.3.2 Checkout Flow
text

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         CHECKOUT FLOW                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                        â”‚
â”‚  1. CART REVIEW                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                          â”‚
â”‚  â”‚  Client  â”‚â”€â”€â”€â”€ GET /api/cart â”€â”€â”€â”€â–¶ Validate stock â”€â”€â–¶ Return cart  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                          â”‚
â”‚       â”‚                                                                â”‚
â”‚       â–¼                                                                â”‚
â”‚  2. CHECKOUT INITIATION                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                          â”‚
â”‚  â”‚  Client  â”‚â”€â”€â”€â”€ POST /api/checkout/session â”€â”€â”€â”€â”                     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                     â”‚                    â”‚
â”‚                                                   â–¼                    â”‚
â”‚                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚                              â”‚         SERVER ACTION           â”‚       â”‚
â”‚                              â”‚                                 â”‚       â”‚
â”‚                              â”‚  1. Validate cart items         â”‚       â”‚
â”‚                              â”‚  2. Check inventory             â”‚       â”‚
â”‚                              â”‚  3. Calculate totals            â”‚       â”‚
â”‚                              â”‚  4. Create Stripe session       â”‚       â”‚
â”‚                              â”‚  5. Create pending order        â”‚       â”‚
â”‚                              â”‚  6. Reserve inventory           â”‚       â”‚
â”‚                              â”‚  7. Return checkout URL         â”‚       â”‚
â”‚                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                                              â”‚                         â”‚
â”‚       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                         â”‚
â”‚       â–¼                                                                â”‚
â”‚  3. STRIPE CHECKOUT                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
â”‚  â”‚  Client  â”‚â”€â”€â”€â”€â–¶â”‚  Stripe  â”‚â”€â”€â”€â”€â–¶â”‚ Payment  â”‚                       â”‚
â”‚  â”‚ Redirect â”‚     â”‚ Checkout â”‚     â”‚ Complete â”‚                       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
â”‚                                         â”‚                              â”‚
â”‚                                         â–¼                              â”‚
â”‚  4. WEBHOOK CONFIRMATION                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
â”‚  â”‚  Stripe  â”‚â”€â”€â”€â”€â–¶â”‚  Webhook â”‚â”€â”€â”€â”€â–¶â”‚  Update  â”‚                       â”‚
â”‚  â”‚ Webhook  â”‚     â”‚  /api/   â”‚     â”‚  Order   â”‚                       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
â”‚                                         â”‚                              â”‚
â”‚                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚                        â–¼                â–¼                â–¼             â”‚
â”‚                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚                   â”‚ Confirm â”‚     â”‚  Send   â”‚     â”‚ Update  â”‚         â”‚
â”‚                   â”‚ Order   â”‚     â”‚ Receipt â”‚     â”‚Inventoryâ”‚         â”‚
â”‚                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                                                        â”‚
â”‚  5. SUCCESS REDIRECT                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                          â”‚
â”‚  â”‚  Client  â”‚â—€â”€â”€â”€â”€ Redirect to /checkout/success?order_id=xxx         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                          â”‚
â”‚                                                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
3. Database Schema
3.1 Entity Relationship Diagram
text

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        ATELIER ARÃ”ME ERD                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                         â”‚
â”‚  â”‚     Category     â”‚         â”‚      Product     â”‚                         â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                         â”‚
â”‚  â”‚ id              â—€â”€â”€â”€â”     â”‚ id               â”‚                         â”‚
â”‚  â”‚ slug             â”‚   â”‚     â”‚ sku              â”‚                         â”‚
â”‚  â”‚ name             â”‚   â”‚     â”‚ slug             â”‚                         â”‚
â”‚  â”‚ description      â”‚   â””â”€â”€â”€â”€â”€â”¤ category_id      â”‚                         â”‚
â”‚  â”‚ image_url        â”‚         â”‚ latin_name       â”‚                         â”‚
â”‚  â”‚ is_featured      â”‚         â”‚ common_name      â”‚                         â”‚
â”‚  â”‚ display_order    â”‚         â”‚ description      â”‚                         â”‚
â”‚  â”‚ created_at       â”‚         â”‚ excerpt          â”‚                         â”‚
â”‚  â”‚ updated_at       â”‚         â”‚ humour           â”‚                         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚ rarity           â”‚                         â”‚
â”‚                               â”‚ season           â”‚                         â”‚
â”‚                               â”‚ notes            â”‚ (JSON array)            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚ extraction       â”‚                         â”‚
â”‚  â”‚   ProductImage   â”‚         â”‚ folio_number     â”‚                         â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤         â”‚ price            â”‚                         â”‚
â”‚  â”‚ id               â”‚         â”‚ compare_at_price â”‚                         â”‚
â”‚  â”‚ product_id      â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚ is_featured      â”‚                         â”‚
â”‚  â”‚ url              â”‚         â”‚ is_active        â”‚                         â”‚
â”‚  â”‚ alt_text         â”‚         â”‚ seo_title        â”‚                         â”‚
â”‚  â”‚ position         â”‚         â”‚ seo_description  â”‚                         â”‚
â”‚  â”‚ is_primary       â”‚         â”‚ created_at       â”‚                         â”‚
â”‚  â”‚ created_at       â”‚         â”‚ updated_at       â”‚                         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                         â”‚
â”‚                                        â”‚                                    â”‚
â”‚                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚
â”‚                          â–¼                           â–¼                      â”‚
â”‚           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚           â”‚  ProductVariant  â”‚         â”‚   Testimonial    â”‚                â”‚
â”‚           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                â”‚
â”‚           â”‚ id               â”‚         â”‚ id               â”‚                â”‚
â”‚           â”‚ product_id       â”‚         â”‚ product_id (opt) â”‚                â”‚
â”‚           â”‚ sku              â”‚         â”‚ author_name      â”‚                â”‚
â”‚           â”‚ name             â”‚         â”‚ author_title     â”‚                â”‚
â”‚           â”‚ size_ml          â”‚         â”‚ quote            â”‚                â”‚
â”‚           â”‚ price            â”‚         â”‚ is_illuminated   â”‚                â”‚
â”‚           â”‚ stock_quantity   â”‚         â”‚ is_verified      â”‚                â”‚
â”‚           â”‚ is_default       â”‚         â”‚ folio_reference  â”‚                â”‚
â”‚           â”‚ created_at       â”‚         â”‚ is_published     â”‚                â”‚
â”‚           â”‚ updated_at       â”‚         â”‚ created_at       â”‚                â”‚
â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚                    â”‚                                                        â”‚
â”‚           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                             â”‚
â”‚           â–¼                  â–¼                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                â”‚
â”‚  â”‚   Inventory      â”‚  â”‚   CartItem       â”‚                                â”‚
â”‚  â”‚   Transaction    â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                                â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚ id               â”‚                                â”‚
â”‚  â”‚ id               â”‚  â”‚ cart_id         â”€â”¼â”€â”€â”€â”€â”€â”                          â”‚
â”‚  â”‚ variant_id       â”‚  â”‚ variant_id       â”‚     â”‚                          â”‚
â”‚  â”‚ type             â”‚  â”‚ quantity         â”‚     â”‚                          â”‚
â”‚  â”‚ quantity_change  â”‚  â”‚ created_at       â”‚     â”‚                          â”‚
â”‚  â”‚ reference_type   â”‚  â”‚ updated_at       â”‚     â”‚                          â”‚
â”‚  â”‚ reference_id     â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚                          â”‚
â”‚  â”‚ notes            â”‚                           â”‚                          â”‚
â”‚  â”‚ created_at       â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚                          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚      Cart        â”‚â—€â”€â”€â”€â”€â”˜                          â”‚
â”‚                        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                                â”‚
â”‚                        â”‚ id               â”‚                                â”‚
â”‚                        â”‚ session_id       â”‚                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ customer_id (opt)â”‚                                â”‚
â”‚  â”‚    Customer      â”‚â—€â”€â”¤                  â”‚                                â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚ expires_at       â”‚                                â”‚
â”‚  â”‚ id               â”‚  â”‚ created_at       â”‚                                â”‚
â”‚  â”‚ email            â”‚  â”‚ updated_at       â”‚                                â”‚
â”‚  â”‚ password_hash    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                â”‚
â”‚  â”‚ first_name       â”‚                                                      â”‚
â”‚  â”‚ last_name        â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                â”‚
â”‚  â”‚ phone            â”‚  â”‚     Address      â”‚                                â”‚
â”‚  â”‚ email_verified   â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                                â”‚
â”‚  â”‚ marketing_opt_in â”‚  â”‚ id               â”‚                                â”‚
â”‚  â”‚ created_at       â”‚  â”‚ customer_id     â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚ updated_at       â”‚  â”‚ type             â”‚ (billing/shipping)â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ first_name       â”‚                   â”‚            â”‚
â”‚           â”‚            â”‚ last_name        â”‚                   â”‚            â”‚
â”‚           â”‚            â”‚ line1            â”‚                   â”‚            â”‚
â”‚           â”‚            â”‚ line2            â”‚                   â”‚            â”‚
â”‚           â–¼            â”‚ city             â”‚                   â”‚            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ state            â”‚                   â”‚            â”‚
â”‚  â”‚      Order       â”‚  â”‚ postal_code      â”‚                   â”‚            â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚ country          â”‚                   â”‚            â”‚
â”‚  â”‚ id               â”‚  â”‚ phone            â”‚                   â”‚            â”‚
â”‚  â”‚ order_number     â”‚  â”‚ is_default       â”‚                   â”‚            â”‚
â”‚  â”‚ customer_id     â”€â”¼â”€â”€â”‚ created_at       â”‚                   â”‚            â”‚
â”‚  â”‚ status           â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚            â”‚
â”‚  â”‚ subtotal         â”‚                                         â”‚            â”‚
â”‚  â”‚ tax              â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚            â”‚
â”‚  â”‚ shipping_cost    â”‚  â”‚   OrderItem      â”‚                   â”‚            â”‚
â”‚  â”‚ discount         â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                   â”‚            â”‚
â”‚  â”‚ total            â”‚  â”‚ id               â”‚                   â”‚            â”‚
â”‚  â”‚ shipping_addr_idâ”€â”¼â”€â”€â”‚ order_id        â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤            â”‚
â”‚  â”‚ billing_addr_id â”€â”¼â”€â”€â”‚ variant_id       â”‚                   â”‚            â”‚
â”‚  â”‚ stripe_payment_idâ”‚  â”‚ quantity         â”‚                   â”‚            â”‚
â”‚  â”‚ notes            â”‚  â”‚ unit_price       â”‚                   â”‚            â”‚
â”‚  â”‚ metadata (JSON)  â”‚  â”‚ total_price      â”‚                   â”‚            â”‚
â”‚  â”‚ created_at       â”‚  â”‚ product_snapshot â”‚ (JSON)            â”‚            â”‚
â”‚  â”‚ updated_at       â”‚  â”‚ created_at       â”‚                   â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚            â”‚
â”‚                                                                â”‚            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚            â”‚
â”‚  â”‚   Subscriber     â”‚  â”‚    ContentPage   â”‚                   â”‚            â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                   â”‚            â”‚
â”‚  â”‚ id               â”‚  â”‚ id               â”‚                   â”‚            â”‚
â”‚  â”‚ email            â”‚  â”‚ slug             â”‚                   â”‚            â”‚
â”‚  â”‚ name             â”‚  â”‚ title            â”‚                   â”‚            â”‚
â”‚  â”‚ source           â”‚  â”‚ content          â”‚ (JSON/MDX)        â”‚            â”‚
â”‚  â”‚ subscribed_at    â”‚  â”‚ seo_title        â”‚                   â”‚            â”‚
â”‚  â”‚ confirmed_at     â”‚  â”‚ seo_description  â”‚                   â”‚            â”‚
â”‚  â”‚ unsubscribed_at  â”‚  â”‚ is_published     â”‚                   â”‚            â”‚
â”‚  â”‚ confirmation_tkn â”‚  â”‚ published_at     â”‚                   â”‚            â”‚
â”‚  â”‚ created_at       â”‚  â”‚ created_at       â”‚                   â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ updated_at       â”‚                   â”‚            â”‚
â”‚                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚            â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                      â”‚
â”‚  â”‚   AdminUser      â”‚                                                      â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                                                      â”‚
â”‚  â”‚ id               â”‚                                                      â”‚
â”‚  â”‚ email            â”‚                                                      â”‚
â”‚  â”‚ password_hash    â”‚                                                      â”‚
â”‚  â”‚ name             â”‚                                                      â”‚
â”‚  â”‚ role             â”‚ (admin, editor, viewer)                              â”‚
â”‚  â”‚ last_login_at    â”‚                                                      â”‚
â”‚  â”‚ created_at       â”‚                                                      â”‚
â”‚  â”‚ updated_at       â”‚                                                      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                      â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
3.2 Complete Prisma Schema
prisma

// prisma/schema.prisma

generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["fullTextSearch", "fullTextIndex"]
}

datasource db {
  provider  = "postgresql"
  url       = env("DATABASE_URL")
  directUrl = env("DIRECT_URL")
}

// ============================================
// ENUMS
// ============================================

enum Humour {
  CALMING
  UPLIFTING
  GROUNDING
  CLARIFYING
}

enum Rarity {
  COMMON
  RARE
  LIMITED
}

enum Season {
  SPRING
  SUMMER
  AUTUMN
  WINTER
}

enum OrderStatus {
  PENDING
  CONFIRMED
  PROCESSING
  SHIPPED
  DELIVERED
  CANCELLED
  REFUNDED
}

enum AddressType {
  BILLING
  SHIPPING
}

enum InventoryTransactionType {
  ADJUSTMENT
  SALE
  RETURN
  RESTOCK
  RESERVATION
  RESERVATION_RELEASE
}

enum AdminRole {
  ADMIN
  EDITOR
  VIEWER
}

enum SubscriberSource {
  WEBSITE_FOOTER
  CORRESPONDENCE_SECTION
  CHECKOUT
  POPUP
  IMPORT
}

// ============================================
// CATALOG MODELS
// ============================================

model Category {
  id           String    @id @default(cuid())
  slug         String    @unique
  name         String
  description  String?   @db.Text
  imageUrl     String?   @map("image_url")
  isFeatured   Boolean   @default(false) @map("is_featured")
  displayOrder Int       @default(0) @map("display_order")
  createdAt    DateTime  @default(now()) @map("created_at")
  updatedAt    DateTime  @updatedAt @map("updated_at")

  products Product[]

  @@map("categories")
}

model Product {
  id              String    @id @default(cuid())
  sku             String    @unique
  slug            String    @unique
  categoryId      String?   @map("category_id")
  latinName       String    @map("latin_name")
  commonName      String    @map("common_name")
  description     String    @db.Text
  excerpt         String?   @db.Text
  humour          Humour
  rarity          Rarity    @default(COMMON)
  season          Season
  notes           String[]  // Array of scent notes
  extraction      String    @default("Steam Distillation")
  folioNumber     String    @map("folio_number") // Roman numeral display
  price           Decimal   @db.Decimal(10, 2)
  compareAtPrice  Decimal?  @map("compare_at_price") @db.Decimal(10, 2)
  isFeatured      Boolean   @default(false) @map("is_featured")
  isActive        Boolean   @default(true) @map("is_active")
  seoTitle        String?   @map("seo_title")
  seoDescription  String?   @map("seo_description") @db.Text
  createdAt       DateTime  @default(now()) @map("created_at")
  updatedAt       DateTime  @updatedAt @map("updated_at")

  category     Category?           @relation(fields: [categoryId], references: [id])
  images       ProductImage[]
  variants     ProductVariant[]
  testimonials Testimonial[]

  @@index([categoryId])
  @@index([humour])
  @@index([rarity])
  @@index([season])
  @@index([isFeatured, isActive])
  @@map("products")
}

model ProductImage {
  id        String   @id @default(cuid())
  productId String   @map("product_id")
  url       String
  altText   String?  @map("alt_text")
  position  Int      @default(0)
  isPrimary Boolean  @default(false) @map("is_primary")
  createdAt DateTime @default(now()) @map("created_at")

  product Product @relation(fields: [productId], references: [id], onDelete: Cascade)

  @@index([productId])
  @@map("product_images")
}

model ProductVariant {
  id            String   @id @default(cuid())
  productId     String   @map("product_id")
  sku           String   @unique
  name          String   // e.g., "5ml Phial", "15ml Bottle"
  sizeMl        Int      @map("size_ml")
  price         Decimal  @db.Decimal(10, 2)
  stockQuantity Int      @default(0) @map("stock_quantity")
  lowStockAlert Int      @default(5) @map("low_stock_alert")
  isDefault     Boolean  @default(false) @map("is_default")
  isActive      Boolean  @default(true) @map("is_active")
  createdAt     DateTime @default(now()) @map("created_at")
  updatedAt     DateTime @updatedAt @map("updated_at")

  product               Product                @relation(fields: [productId], references: [id], onDelete: Cascade)
  cartItems             CartItem[]
  orderItems            OrderItem[]
  inventoryTransactions InventoryTransaction[]

  @@index([productId])
  @@index([stockQuantity])
  @@map("product_variants")
}

model InventoryTransaction {
  id             String                   @id @default(cuid())
  variantId      String                   @map("variant_id")
  type           InventoryTransactionType
  quantityChange Int                      @map("quantity_change") // Can be negative
  referenceType  String?                  @map("reference_type") // "order", "adjustment"
  referenceId    String?                  @map("reference_id")
  notes          String?                  @db.Text
  createdAt      DateTime                 @default(now()) @map("created_at")
  createdBy      String?                  @map("created_by") // Admin user ID

  variant ProductVariant @relation(fields: [variantId], references: [id])

  @@index([variantId])
  @@index([referenceType, referenceId])
  @@map("inventory_transactions")
}

// ============================================
// CUSTOMER MODELS
// ============================================

model Customer {
  id              String    @id @default(cuid())
  email           String    @unique
  passwordHash    String?   @map("password_hash")
  firstName       String?   @map("first_name")
  lastName        String?   @map("last_name")
  phone           String?
  emailVerified   DateTime? @map("email_verified")
  marketingOptIn  Boolean   @default(false) @map("marketing_opt_in")
  createdAt       DateTime  @default(now()) @map("created_at")
  updatedAt       DateTime  @updatedAt @map("updated_at")

  addresses Address[]
  orders    Order[]
  carts     Cart[]
  accounts  Account[] // For OAuth providers

  @@map("customers")
}

model Account {
  id                String  @id @default(cuid())
  customerId        String  @map("customer_id")
  type              String
  provider          String
  providerAccountId String  @map("provider_account_id")
  refresh_token     String? @db.Text
  access_token      String? @db.Text
  expires_at        Int?
  token_type        String?
  scope             String?
  id_token          String? @db.Text
  session_state     String?

  customer Customer @relation(fields: [customerId], references: [id], onDelete: Cascade)

  @@unique([provider, providerAccountId])
  @@index([customerId])
  @@map("accounts")
}

model Address {
  id         String      @id @default(cuid())
  customerId String      @map("customer_id")
  type       AddressType
  firstName  String      @map("first_name")
  lastName   String      @map("last_name")
  company    String?
  line1      String
  line2      String?
  city       String
  state      String?
  postalCode String      @map("postal_code")
  country    String      @default("US")
  phone      String?
  isDefault  Boolean     @default(false) @map("is_default")
  createdAt  DateTime    @default(now()) @map("created_at")
  updatedAt  DateTime    @updatedAt @map("updated_at")

  customer       Customer @relation(fields: [customerId], references: [id], onDelete: Cascade)
  shippingOrders Order[]  @relation("ShippingAddress")
  billingOrders  Order[]  @relation("BillingAddress")

  @@index([customerId])
  @@map("addresses")
}

// ============================================
// CART MODELS
// ============================================

model Cart {
  id         String    @id @default(cuid())
  sessionId  String?   @unique @map("session_id")
  customerId String?   @map("customer_id")
  expiresAt  DateTime  @map("expires_at")
  createdAt  DateTime  @default(now()) @map("created_at")
  updatedAt  DateTime  @updatedAt @map("updated_at")

  customer Customer?  @relation(fields: [customerId], references: [id])
  items    CartItem[]

  @@index([customerId])
  @@index([expiresAt])
  @@map("carts")
}

model CartItem {
  id        String   @id @default(cuid())
  cartId    String   @map("cart_id")
  variantId String   @map("variant_id")
  quantity  Int      @default(1)
  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @updatedAt @map("updated_at")

  cart    Cart           @relation(fields: [cartId], references: [id], onDelete: Cascade)
  variant ProductVariant @relation(fields: [variantId], references: [id])

  @@unique([cartId, variantId])
  @@index([cartId])
  @@index([variantId])
  @@map("cart_items")
}

// ============================================
// ORDER MODELS
// ============================================

model Order {
  id                String      @id @default(cuid())
  orderNumber       String      @unique @map("order_number")
  customerId        String?     @map("customer_id")
  customerEmail     String      @map("customer_email")
  status            OrderStatus @default(PENDING)
  subtotal          Decimal     @db.Decimal(10, 2)
  tax               Decimal     @default(0) @db.Decimal(10, 2)
  shippingCost      Decimal     @default(0) @map("shipping_cost") @db.Decimal(10, 2)
  discount          Decimal     @default(0) @db.Decimal(10, 2)
  total             Decimal     @db.Decimal(10, 2)
  shippingAddressId String?     @map("shipping_address_id")
  billingAddressId  String?     @map("billing_address_id")
  shippingMethod    String?     @map("shipping_method")
  trackingNumber    String?     @map("tracking_number")
  stripePaymentId   String?     @map("stripe_payment_id")
  stripeSessionId   String?     @map("stripe_session_id")
  notes             String?     @db.Text
  metadata          Json?       @default("{}")
  createdAt         DateTime    @default(now()) @map("created_at")
  updatedAt         DateTime    @updatedAt @map("updated_at")

  customer        Customer?   @relation(fields: [customerId], references: [id])
  shippingAddress Address?    @relation("ShippingAddress", fields: [shippingAddressId], references: [id])
  billingAddress  Address?    @relation("BillingAddress", fields: [billingAddressId], references: [id])
  items           OrderItem[]

  @@index([customerId])
  @@index([status])
  @@index([createdAt])
  @@index([stripePaymentId])
  @@map("orders")
}

model OrderItem {
  id              String   @id @default(cuid())
  orderId         String   @map("order_id")
  variantId       String   @map("variant_id")
  quantity        Int
  unitPrice       Decimal  @map("unit_price") @db.Decimal(10, 2)
  totalPrice      Decimal  @map("total_price") @db.Decimal(10, 2)
  productSnapshot Json     @map("product_snapshot") // Preserve product details at order time
  createdAt       DateTime @default(now()) @map("created_at")

  order   Order          @relation(fields: [orderId], references: [id], onDelete: Cascade)
  variant ProductVariant @relation(fields: [variantId], references: [id])

  @@index([orderId])
  @@index([variantId])
  @@map("order_items")
}

// ============================================
// CONTENT MODELS
// ============================================

model Testimonial {
  id             String   @id @default(cuid())
  productId      String?  @map("product_id")
  authorName     String   @map("author_name")
  authorTitle    String?  @map("author_title")
  quote          String   @db.Text
  isIlluminated  Boolean  @default(false) @map("is_illuminated") // Featured
  isVerified     Boolean  @default(false) @map("is_verified")
  folioReference String?  @map("folio_reference") // e.g., "Folio VII, Entry 12"
  isPublished    Boolean  @default(false) @map("is_published")
  displayOrder   Int      @default(0) @map("display_order")
  createdAt      DateTime @default(now()) @map("created_at")
  updatedAt      DateTime @updatedAt @map("updated_at")

  product Product? @relation(fields: [productId], references: [id])

  @@index([productId])
  @@index([isPublished, isIlluminated])
  @@map("testimonials")
}

model ContentPage {
  id             String    @id @default(cuid())
  slug           String    @unique
  title          String
  content        Json      // Structured content (blocks, MDX, etc.)
  seoTitle       String?   @map("seo_title")
  seoDescription String?   @map("seo_description") @db.Text
  isPublished    Boolean   @default(false) @map("is_published")
  publishedAt    DateTime? @map("published_at")
  createdAt      DateTime  @default(now()) @map("created_at")
  updatedAt      DateTime  @updatedAt @map("updated_at")

  @@map("content_pages")
}

model Subscriber {
  id                String           @id @default(cuid())
  email             String           @unique
  name              String?
  source            SubscriberSource @default(WEBSITE_FOOTER)
  confirmationToken String?          @unique @map("confirmation_token")
  subscribedAt      DateTime         @default(now()) @map("subscribed_at")
  confirmedAt       DateTime?        @map("confirmed_at")
  unsubscribedAt    DateTime?        @map("unsubscribed_at")
  createdAt         DateTime         @default(now()) @map("created_at")

  @@index([confirmedAt])
  @@map("subscribers")
}

// ============================================
// ADMIN MODELS
// ============================================

model AdminUser {
  id           String    @id @default(cuid())
  email        String    @unique
  passwordHash String    @map("password_hash")
  name         String
  role         AdminRole @default(EDITOR)
  lastLoginAt  DateTime? @map("last_login_at")
  createdAt    DateTime  @default(now()) @map("created_at")
  updatedAt    DateTime  @updatedAt @map("updated_at")

  @@map("admin_users")
}

// ============================================
// SESSION MODELS (NextAuth)
// ============================================

model Session {
  id           String   @id @default(cuid())
  sessionToken String   @unique @map("session_token")
  customerId   String   @map("customer_id")
  expires      DateTime

  @@index([customerId])
  @@map("sessions")
}

model VerificationToken {
  identifier String
  token      String   @unique
  expires    DateTime

  @@unique([identifier, token])
  @@map("verification_tokens")
}
3.3 Seed Data Specification
TypeScript

// prisma/seed.ts

import { PrismaClient, Humour, Rarity, Season } from '@prisma/client';

const prisma = new PrismaClient();

const ESSENCES_SEED_DATA = [
  {
    sku: 'LAV-724',
    slug: 'provence-lavender',
    latinName: 'Lavandula Ã— intermedia',
    commonName: 'Provence Lavender',
    description: 'Harvested at dawn in the ProvenÃ§al hills, this lavender possesses a sweetness found only in blossoms kissed by the morning\'s first light. Its effect is one of profound calm, like the silence between breaths.',
    excerpt: 'The essence of ProvenÃ§al mornings.',
    humour: Humour.CALMING,
    rarity: Rarity.RARE,
    season: Season.SUMMER,
    notes: ['Floral', 'Herbaceous', 'Sweet'],
    extraction: 'Steam Distillation',
    folioNumber: 'I',
    isFeatured: true,
    variants: [
      { sku: 'LAV-724-5ML', name: '5ml Phial', sizeMl: 5, price: 42.00, stock: 50, isDefault: true },
      { sku: 'LAV-724-15ML', name: '15ml Bottle', sizeMl: 15, price: 98.00, stock: 25 },
    ],
  },
  {
    sku: 'EUC-511',
    slug: 'tasmanian-eucalyptus',
    latinName: 'Eucalyptus globulus',
    commonName: 'Tasmanian Eucalyptus',
    description: 'The crisp, clean scent of Tasmania\'s ancient forests. This essence clears the mind as morning mist clears from mountain valleys.',
    excerpt: 'Clarity from ancient forests.',
    humour: Humour.CLARIFYING,
    rarity: Rarity.COMMON,
    season: Season.AUTUMN,
    notes: ['Camphorous', 'Fresh', 'Clean'],
    extraction: 'Steam Distillation',
    folioNumber: 'II',
    isFeatured: false,
    variants: [
      { sku: 'EUC-511-5ML', name: '5ml Phial', sizeMl: 5, price: 36.00, stock: 100, isDefault: true },
      { sku: 'EUC-511-15ML', name: '15ml Bottle', sizeMl: 15, price: 84.00, stock: 50 },
    ],
  },
  {
    sku: 'BER-328',
    slug: 'calabrian-bergamot',
    latinName: 'Citrus bergamia',
    commonName: 'Calabrian Bergamot',
    description: 'From Italy\'s sun-drenched Calabrian coast, this essence captures the joyful brightness of citrus groves at harvest. A note of pure sunlight.',
    excerpt: 'Captured Italian sunshine.',
    humour: Humour.UPLIFTING,
    rarity: Rarity.LIMITED,
    season: Season.WINTER,
    notes: ['Citrus', 'Bright', 'Spicy'],
    extraction: 'Cold Press',
    folioNumber: 'III',
    isFeatured: true,
    variants: [
      { sku: 'BER-328-5ML', name: '5ml Phial', sizeMl: 5, price: 48.00, stock: 20, isDefault: true },
    ],
  },
  {
    sku: 'SAN-442',
    slug: 'mysore-sandalwood',
    latinName: 'Santalum album',
    commonName: 'Mysore Sandalwood',
    description: 'From sustainable plantations in Karnataka, this precious wood essence grounds the spirit with its creamy, meditative warmth.',
    excerpt: 'Meditative warmth from India.',
    humour: Humour.GROUNDING,
    rarity: Rarity.RARE,
    season: Season.AUTUMN,
    notes: ['Woody', 'Creamy', 'Warm'],
    extraction: 'Steam Distillation',
    folioNumber: 'IV',
    isFeatured: false,
    variants: [
      { sku: 'SAN-442-5ML', name: '5ml Phial', sizeMl: 5, price: 68.00, stock: 15, isDefault: true },
    ],
  },
  {
    sku: 'PEP-189',
    slug: 'yakima-peppermint',
    latinName: 'Mentha Ã— piperita',
    commonName: 'Yakima Peppermint',
    description: 'Cultivated in Washington\'s Yakima Valley, this peppermint delivers crystalline clarity with a cooling intensity that awakens the senses.',
    excerpt: 'Awakening clarity from the Pacific Northwest.',
    humour: Humour.CLARIFYING,
    rarity: Rarity.COMMON,
    season: Season.SUMMER,
    notes: ['Minty', 'Cooling', 'Crisp'],
    extraction: 'Steam Distillation',
    folioNumber: 'V',
    isFeatured: false,
    variants: [
      { sku: 'PEP-189-5ML', name: '5ml Phial', sizeMl: 5, price: 32.00, stock: 80, isDefault: true },
      { sku: 'PEP-189-15ML', name: '15ml Bottle', sizeMl: 15, price: 74.00, stock: 40 },
    ],
  },
  {
    sku: 'ROS-655',
    slug: 'damascus-rose',
    latinName: 'Rosa Ã— damascena',
    commonName: 'Damascus Rose',
    description: 'Hand-harvested at dawn in the Valley of Roses, each drop of this otto requires thousands of petals. An essence of profound emotional depth.',
    excerpt: 'The queen of flowers, distilled.',
    humour: Humour.CALMING,
    rarity: Rarity.LIMITED,
    season: Season.SPRING,
    notes: ['Floral', 'Rich', 'Romantic'],
    extraction: 'Steam Distillation',
    folioNumber: 'VI',
    isFeatured: true,
    variants: [
      { sku: 'ROS-655-3ML', name: '3ml Phial', sizeMl: 3, price: 125.00, stock: 10, isDefault: true },
    ],
  },
];

const TESTIMONIALS_SEED_DATA = [
  {
    authorName: 'Isabelle Moreau',
    authorTitle: 'Writer & Historian, Paris',
    quote: 'The Provence Lavender has transformed my evening ritual into a sacred practice. Its scent is not merely pleasantâ€”it is profound, layered, and seems to hold within it the very quiet of the ProvenÃ§al hills at dusk. This is not aromatherapy; it is time travel for the senses.',
    isIlluminated: true,
    isVerified: true,
    folioReference: 'Folio VII, Entry 12',
    isPublished: true,
    displayOrder: 1,
  },
  {
    authorName: 'Marco Ferrara',
    authorTitle: 'Michelin-starred Chef, Florence',
    quote: 'As a chef, I understand transformation. What Atelier ArÃ´me achieves with botanicals is culinary artistry for the soul. The Calabrian Bergamot is sunshine capturedâ€”it brightens not just a room, but one\'s very disposition.',
    isIlluminated: false,
    isVerified: true,
    folioReference: 'Folio VIII, Entry 3',
    isPublished: true,
    displayOrder: 2,
  },
  {
    authorName: 'Dr. Evelyn Reed',
    authorTitle: 'Botanical Researcher, Oxford',
    quote: 'The attention to detail is evident in every aspect. From the wax seal on the phial to the complexity of the scent itselfâ€”this is craftsmanship of the highest order. Each essence tells a story.',
    isIlluminated: false,
    isVerified: true,
    folioReference: 'Folio IX, Entry 7',
    isPublished: true,
    displayOrder: 3,
  },
];

const CATEGORIES_SEED_DATA = [
  {
    slug: 'calming-essences',
    name: 'Calming Essences',
    description: 'Essences that quiet the mind and soothe the spirit.',
    isFeatured: true,
    displayOrder: 1,
  },
  {
    slug: 'uplifting-essences',
    name: 'Uplifting Essences',
    description: 'Bright, energizing essences that elevate mood and spirit.',
    isFeatured: true,
    displayOrder: 2,
  },
  {
    slug: 'grounding-essences',
    name: 'Grounding Essences',
    description: 'Deep, warm essences that anchor and center.',
    isFeatured: false,
    displayOrder: 3,
  },
  {
    slug: 'clarifying-essences',
    name: 'Clarifying Essences',
    description: 'Fresh, clear essences that sharpen focus and clear the mind.',
    isFeatured: false,
    displayOrder: 4,
  },
];

async function main() {
  console.log('ğŸŒ¿ Seeding Atelier ArÃ´me database...');

  // Seed Categories
  for (const category of CATEGORIES_SEED_DATA) {
    await prisma.category.upsert({
      where: { slug: category.slug },
      update: category,
      create: category,
    });
  }
  console.log('âœ“ Categories seeded');

  // Seed Products with Variants
  for (const essence of ESSENCES_SEED_DATA) {
    const { variants, ...productData } = essence;
    
    // Find matching category
    const categorySlug = `${essence.humour.toLowerCase()}-essences`;
    const category = await prisma.category.findUnique({
      where: { slug: categorySlug.replace('_', '-') },
    });

    const product = await prisma.product.upsert({
      where: { sku: productData.sku },
      update: {
        ...productData,
        categoryId: category?.id,
        price: variants[0].price,
      },
      create: {
        ...productData,
        categoryId: category?.id,
        price: variants[0].price,
      },
    });

    // Create variants
    for (const variant of variants) {
      await prisma.productVariant.upsert({
        where: { sku: variant.sku },
        update: {
          productId: product.id,
          name: variant.name,
          sizeMl: variant.sizeMl,
          price: variant.price,
          stockQuantity: variant.stock,
          isDefault: variant.isDefault ?? false,
        },
        create: {
          productId: product.id,
          sku: variant.sku,
          name: variant.name,
          sizeMl: variant.sizeMl,
          price: variant.price,
          stockQuantity: variant.stock,
          isDefault: variant.isDefault ?? false,
        },
      });
    }
  }
  console.log('âœ“ Products and variants seeded');

  // Seed Testimonials
  for (const testimonial of TESTIMONIALS_SEED_DATA) {
    await prisma.testimonial.upsert({
      where: { id: testimonial.authorName.replace(/\s+/g, '-').toLowerCase() },
      update: testimonial,
      create: testimonial,
    });
  }
  console.log('âœ“ Testimonials seeded');

  // Create Admin User
  const bcrypt = await import('bcryptjs');
  const hashedPassword = await bcrypt.hash('admin123!', 12);
  
  await prisma.adminUser.upsert({
    where: { email: 'admin@atelierarome.com' },
    update: {},
    create: {
      email: 'admin@atelierarome.com',
      passwordHash: hashedPassword,
      name: 'Master Perfumer',
      role: 'ADMIN',
    },
  });
  console.log('âœ“ Admin user seeded');

  console.log('ğŸ¨ Atelier ArÃ´me database seeded successfully!');
}

main()
  .catch((e) => {
    console.error(e);
    process.exit(1);
  })
  .finally(async () => {
    await prisma.$disconnect();
  });
4. API Specification
4.1 API Overview
Category	Base Path	Authentication
Products	/api/products	Public
Cart	/api/cart	Session-based
Checkout	/api/checkout	Session-based
Orders	/api/orders	Authenticated
Account	/api/account	Authenticated
Newsletter	/api/newsletter	Public
Admin	/api/admin	Admin Role
Webhooks	/api/webhooks	Signature Verified
4.2 Detailed Endpoint Specifications
4.2.1 Products API
TypeScript

// ============================================
// GET /api/products
// List products with filtering and pagination
// ============================================

// Request Query Parameters
interface ProductListParams {
  page?: number;           // Default: 1
  limit?: number;          // Default: 12, Max: 50
  humour?: Humour;         // Filter by humour
  rarity?: Rarity;         // Filter by rarity
  season?: Season;         // Filter by season
  category?: string;       // Category slug
  featured?: boolean;      // Only featured products
  sort?: 'price_asc' | 'price_desc' | 'newest' | 'folio'; // Default: folio
  search?: string;         // Full-text search
}

// Response
interface ProductListResponse {
  data: ProductSummary[];
  meta: {
    total: number;
    page: number;
    limit: number;
    totalPages: number;
  };
  filters: {
    humours: { value: Humour; count: number }[];
    rarities: { value: Rarity; count: number }[];
    seasons: { value: Season; count: number }[];
    priceRange: { min: number; max: number };
  };
}

interface ProductSummary {
  id: string;
  slug: string;
  sku: string;
  commonName: string;
  latinName: string;
  excerpt: string;
  humour: Humour;
  rarity: Rarity;
  season: Season;
  folioNumber: string;
  price: number;
  compareAtPrice: number | null;
  isFeatured: boolean;
  primaryImage: {
    url: string;
    altText: string;
  } | null;
  defaultVariant: {
    id: string;
    sku: string;
    name: string;
    price: number;
    inStock: boolean;
  };
}

// ============================================
// GET /api/products/:slug
// Get single product details
// ============================================

interface ProductDetailResponse {
  id: string;
  slug: string;
  sku: string;
  commonName: string;
  latinName: string;
  description: string;
  excerpt: string;
  humour: Humour;
  rarity: Rarity;
  season: Season;
  notes: string[];
  extraction: string;
  folioNumber: string;
  price: number;
  compareAtPrice: number | null;
  isFeatured: boolean;
  category: {
    slug: string;
    name: string;
  } | null;
  images: {
    id: string;
    url: string;
    altText: string;
    isPrimary: boolean;
  }[];
  variants: {
    id: string;
    sku: string;
    name: string;
    sizeMl: number;
    price: number;
    inStock: boolean;
    stockQuantity: number;
    isDefault: boolean;
  }[];
  relatedProducts: ProductSummary[];
  seo: {
    title: string;
    description: string;
  };
}
4.2.2 Cart API
TypeScript

// ============================================
// GET /api/cart
// Get current cart
// ============================================

interface CartResponse {
  id: string;
  items: CartItemResponse[];
  subtotal: number;
  itemCount: number;
  estimatedTax: number;
  estimatedTotal: number;
}

interface CartItemResponse {
  id: string;
  quantity: number;
  variant: {
    id: string;
    sku: string;
    name: string;
    sizeMl: number;
    price: number;
    inStock: boolean;
    stockQuantity: number;
  };
  product: {
    id: string;
    slug: string;
    commonName: string;
    latinName: string;
    humour: Humour;
    primaryImage: {
      url: string;
      altText: string;
    } | null;
  };
  lineTotal: number;
}

// ============================================
// POST /api/cart/items
// Add item to cart
// ============================================

interface AddToCartRequest {
  variantId: string;
  quantity: number; // Min: 1, Max: 10
}

interface AddToCartResponse {
  success: boolean;
  cart: CartResponse;
  addedItem: CartItemResponse;
}

// ============================================
// PATCH /api/cart/items/:itemId
// Update cart item quantity
// ============================================

interface UpdateCartItemRequest {
  quantity: number; // Min: 0 (0 removes item), Max: 10
}

// ============================================
// DELETE /api/cart/items/:itemId
// Remove item from cart
// ============================================

// Returns updated CartResponse

// ============================================
// DELETE /api/cart
// Clear entire cart
// ============================================

// Returns empty CartResponse
4.2.3 Checkout API
TypeScript

// ============================================
// POST /api/checkout/session
// Create Stripe checkout session
// ============================================

interface CreateCheckoutRequest {
  shippingAddress?: {
    firstName: string;
    lastName: string;
    line1: string;
    line2?: string;
    city: string;
    state?: string;
    postalCode: string;
    country: string;
    phone?: string;
  };
  billingAddress?: {
    // Same as shipping
  };
  sameAsShipping?: boolean;
  email?: string; // Required for guest checkout
}

interface CreateCheckoutResponse {
  sessionId: string;
  checkoutUrl: string;
  orderId: string;
}

// ============================================
// GET /api/checkout/session/:sessionId
// Get checkout session status
// ============================================

interface CheckoutSessionResponse {
  status: 'pending' | 'complete' | 'expired';
  orderId: string | null;
  customerEmail: string;
}

// ============================================
// POST /api/webhooks/stripe
// Stripe webhook handler
// ============================================

// Handles:
// - checkout.session.completed
// - payment_intent.succeeded
// - payment_intent.payment_failed
// - charge.refunded
4.2.4 Orders API
TypeScript

// ============================================
// GET /api/orders
// List customer orders (authenticated)
// ============================================

interface OrderListParams {
  page?: number;
  limit?: number;
  status?: OrderStatus;
}

interface OrderListResponse {
  data: OrderSummary[];
  meta: {
    total: number;
    page: number;
    limit: number;
  };
}

interface OrderSummary {
  id: string;
  orderNumber: string;
  status: OrderStatus;
  total: number;
  itemCount: number;
  createdAt: string;
}

// ============================================
// GET /api/orders/:orderNumber
// Get order details
// ============================================

interface OrderDetailResponse {
  id: string;
  orderNumber: string;
  status: OrderStatus;
  subtotal: number;
  tax: number;
  shippingCost: number;
  discount: number;
  total: number;
  shippingAddress: AddressResponse;
  billingAddress: AddressResponse;
  shippingMethod: string;
  trackingNumber: string | null;
  items: OrderItemResponse[];
  createdAt: string;
  updatedAt: string;
}

interface OrderItemResponse {
  id: string;
  quantity: number;
  unitPrice: number;
  totalPrice: number;
  product: {
    commonName: string;
    latinName: string;
    slug: string;
    primaryImage: string | null;
  };
  variant: {
    name: string;
    sizeMl: number;
  };
}
4.2.5 Account API
TypeScript

// ============================================
// GET /api/account
// Get current user account
// ============================================

interface AccountResponse {
  id: string;
  email: string;
  firstName: string | null;
  lastName: string | null;
  phone: string | null;
  emailVerified: boolean;
  marketingOptIn: boolean;
  createdAt: string;
}

// ============================================
// PATCH /api/account
// Update account details
// ============================================

interface UpdateAccountRequest {
  firstName?: string;
  lastName?: string;
  phone?: string;
  marketingOptIn?: boolean;
}

// ============================================
// GET /api/account/addresses
// List customer addresses
// ============================================

interface AddressListResponse {
  shipping: AddressResponse[];
  billing: AddressResponse[];
}

interface AddressResponse {
  id: string;
  type: AddressType;
  firstName: string;
  lastName: string;
  company: string | null;
  line1: string;
  line2: string | null;
  city: string;
  state: string | null;
  postalCode: string;
  country: string;
  phone: string | null;
  isDefault: boolean;
}

// ============================================
// POST /api/account/addresses
// Create new address
// ============================================

interface CreateAddressRequest {
  type: AddressType;
  firstName: string;
  lastName: string;
  company?: string;
  line1: string;
  line2?: string;
  city: string;
  state?: string;
  postalCode: string;
  country: string;
  phone?: string;
  isDefault?: boolean;
}

// ============================================
// PATCH /api/account/addresses/:id
// Update address
// ============================================

// Same as CreateAddressRequest, all fields optional

// ============================================
// DELETE /api/account/addresses/:id
// Delete address
// ============================================

// Returns 204 No Content
4.2.6 Newsletter API
TypeScript

// ============================================
// POST /api/newsletter/subscribe
// Subscribe to newsletter
// ============================================

interface SubscribeRequest {
  email: string;
  name?: string;
  source?: SubscriberSource;
}

interface SubscribeResponse {
  success: boolean;
  message: string;
  requiresConfirmation: boolean;
}

// ============================================
// GET /api/newsletter/confirm
// Confirm subscription
// ============================================

// Query: ?token=xxx
// Redirects to /correspondence/confirmed or /correspondence/error

// ============================================
// POST /api/newsletter/unsubscribe
// Unsubscribe from newsletter
// ============================================

interface UnsubscribeRequest {
  email: string;
  token?: string; // From email link
}
4.3 Error Response Format
TypeScript

interface ApiError {
  error: {
    code: string;
    message: string;
    details?: Record<string, string[]>; // Validation errors
    requestId?: string;
  };
}

// Error Codes
const ERROR_CODES = {
  // 400 Bad Request
  VALIDATION_ERROR: 'VALIDATION_ERROR',
  INVALID_REQUEST: 'INVALID_REQUEST',
  
  // 401 Unauthorized
  UNAUTHORIZED: 'UNAUTHORIZED',
  INVALID_TOKEN: 'INVALID_TOKEN',
  
  // 403 Forbidden
  FORBIDDEN: 'FORBIDDEN',
  INSUFFICIENT_PERMISSIONS: 'INSUFFICIENT_PERMISSIONS',
  
  // 404 Not Found
  NOT_FOUND: 'NOT_FOUND',
  PRODUCT_NOT_FOUND: 'PRODUCT_NOT_FOUND',
  ORDER_NOT_FOUND: 'ORDER_NOT_FOUND',
  
  // 409 Conflict
  ALREADY_EXISTS: 'ALREADY_EXISTS',
  OUT_OF_STOCK: 'OUT_OF_STOCK',
  
  // 429 Too Many Requests
  RATE_LIMITED: 'RATE_LIMITED',
  
  // 500 Internal Server Error
  INTERNAL_ERROR: 'INTERNAL_ERROR',
  DATABASE_ERROR: 'DATABASE_ERROR',
  PAYMENT_ERROR: 'PAYMENT_ERROR',
};
4.4 Rate Limiting
Endpoint Category	Limit	Window
Public (Products, Testimonials)	100 req	1 minute
Cart Operations	30 req	1 minute
Checkout	10 req	1 minute
Authentication	5 req	1 minute
Newsletter Subscribe	3 req	1 minute
Admin API	60 req	1 minute
Webhooks	No limit	-
5. Frontend Architecture
5.1 Application Structure
text

src/
â”œâ”€â”€ app/                          # Next.js App Router
â”‚   â”œâ”€â”€ (marketing)/              # Marketing pages group
â”‚   â”‚   â”œâ”€â”€ page.tsx              # Home page
â”‚   â”‚   â”œâ”€â”€ alchemy/page.tsx      # Process page
â”‚   â”‚   â”œâ”€â”€ atelier/page.tsx      # About page
â”‚   â”‚   â”œâ”€â”€ manuscript/page.tsx   # Testimonials
â”‚   â”‚   â””â”€â”€ correspondence/page.tsx # Newsletter
â”‚   â”‚
â”‚   â”œâ”€â”€ (shop)/                   # Shop pages group
â”‚   â”‚   â”œâ”€â”€ compendium/
â”‚   â”‚   â”‚   â”œâ”€â”€ page.tsx          # Product listing
â”‚   â”‚   â”‚   â””â”€â”€ [slug]/page.tsx   # Product detail
â”‚   â”‚   â”œâ”€â”€ collections/
â”‚   â”‚   â”‚   â”œâ”€â”€ page.tsx          # Collections listing
â”‚   â”‚   â”‚   â””â”€â”€ [slug]/page.tsx   # Collection detail
â”‚   â”‚   â””â”€â”€ layout.tsx            # Shop layout with cart
â”‚   â”‚
â”‚   â”œâ”€â”€ (checkout)/               # Checkout flow group
â”‚   â”‚   â”œâ”€â”€ cart/page.tsx         # Cart page
â”‚   â”‚   â”œâ”€â”€ checkout/page.tsx     # Checkout page
â”‚   â”‚   â””â”€â”€ checkout/success/page.tsx
â”‚   â”‚
â”‚   â”œâ”€â”€ (account)/                # Account pages group
â”‚   â”‚   â”œâ”€â”€ layout.tsx            # Account layout (requires auth)
â”‚   â”‚   â”œâ”€â”€ page.tsx              # Account dashboard
â”‚   â”‚   â”œâ”€â”€ orders/
â”‚   â”‚   â”‚   â”œâ”€â”€ page.tsx          # Order history
â”‚   â”‚   â”‚   â””â”€â”€ [number]/page.tsx # Order detail
â”‚   â”‚   â””â”€â”€ addresses/page.tsx    # Address management
â”‚   â”‚
â”‚   â”œâ”€â”€ (auth)/                   # Auth pages group
â”‚   â”‚   â”œâ”€â”€ login/page.tsx
â”‚   â”‚   â”œâ”€â”€ register/page.tsx
â”‚   â”‚   â”œâ”€â”€ 
Somethin
